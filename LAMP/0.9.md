#IP地址/子网掩码/网关
####IP地址
互联网上的每个接口必须有唯一的Internet地址(也称为IP地址)，长度为32位(IPv4，最小版本IPv6长度为128位)，Internet地址并不是采用平面形式的地址空间，而是具有一定结构的，5类不同的地址格式             
IP地址由两部分组成，一部分为网络地址，另一部分为主机地址，网络地址的位数直接决定了可以分配的网络数，主机地址的位数则决定了网络中最大的主机数        
```text
       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+    
A 类  |0|  网络号(7位)  |               主机号(24位)                  |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
B 类  |1|0|        网络号(14位)       |           主机号(16位)        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
C 类  |1|1|0|              网络号(21位)               |  主机号(8位)  |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
D 类  |1|1|1|0|                       多播组号(28位)                  |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
E 类  |1|1|1|1|0|                      留待后用(27位)                 |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
```
这些32位的地址通常写成4个十进制的数，其中每个整数对应一个字节，这种表示方法称做"点分十进制表示法(Dotted Decimal Notation)"                
区分各类地址的最简单方法是看它的第一个十进制整数，下表列出了各类地址的起止范围，其中第一个十进制整数用加黑字体表示           
```text
类型    范围
A       0.0.0.0到127.255.255.255
B       128.0.0.0到192.255.255.255
C       192.0.0.0到223.255.255.255
D       224.0.0.0到239.255.255.255
E       240.0.0.0到247.255.255.255
```

IP地址又分为公有地址(Public address)由Inter NIC(Internet Network Information Center 因特网信息中心)负责，这个IP地址分配给注册并向Inter NIC提出申请的组织机构，通过它直接访问因特网            
随着互联网的发展，IP地址已经不够使用，为了节省可分配的注册IP地址，有一组IP地址拿出来专门用于私有IP网络，称为私用地址(Private address)         
```text
A类  10.0.0.0~10.255.255.255      即10.0.0.0/8
B类  172.16.0.0~172.31.255.255    即172.16.0.0/12
C类  192.168.0.0~192.168.255.255  即192.168.0.0/16
```
这些地址是不会被Internet分配的，它们在Internet上也不会被路由，虽然它们不能直接和Internet连接，但是通过技术仍旧可以和Internet通讯(NAT技术)，以节省IP地址资源      
####子网掩码
子网掩码，只要分为两类，一类是缺省子网掩码，一类是自定义的子网掩码               
所谓缺省就是默认的子网掩码，一般我们使用的都是A、B、C类IP地址，对于的子网掩码就是`255.0.0.0`、`255.255.0.0`、`255.255.255.0`         
那么子网掩码的作用是什么呢？            
首先，子网掩码使用的C语言的位与，两个数为1值为1，否则为0         
子网掩码与IP地址对应，IP地址中的网络号全部用1表示，主机号全部用0表示，例如IP地址192.168.0.1
```text
IP    192.168.0.1
IP    1100 0000 . 1010 1000 . 0000 0000 . 0000 0001
MASK  1111 1111 . 1111 1111 . 1111 1111 . 0000 0000  位与
---------------------------------------------------
&     1100 0000 . 1010 1000 . 0000 0000 . 0000 0000
```
如上我们可以很直观的看到，当IP地址和子网掩码位与之后，得到的`192.168.0.0`就是网络号        
把子网掩码与`255.255.255.255`异或后，得到子网掩码的反码，再把子网掩码的反码与IP地址位与，得到`0.0.0.1`就是主机号            
```text
MASK  1111 1111 . 1111 1111 . 1111 1111 . 0000 0000
^     1111 1111 . 1111 1111 . 1111 1111 . 1111 1111  位与
---------------------------------------------------
^MASK 0000 0000 . 0000 0000 . 0000 0000 . 1111 1111  反码
IP    1100 0000 . 1010 1000 . 0000 0000 . 0000 0001
---------------------------------------------------
&     0000 0000 . 0000 0000 . 0000 0000 . 0000 0001  位与
```

上面我们讲了IP地址是由网络号和主机号组成的，而子网掩码是判断哪一部分是网络号，哪一部分为主机号           
而自定义子网掩码，是把主机号中的一部分用来划分为子网，剩下的为主机号       
同时我们用子网掩码划分的不同子网，默认是不能互相访问的，因为他们的网络号不同，而路由器正是通过把IP地址与子网掩码位与后，进行比较来判断两个IP地址是否处于同一个网络 
```text
IP地址  网络号+主机号
IP地址  网络号+子网+主机号
```              

所以在我们自定义子网掩码的时候，就用多种方法来计算子网掩码了              
例如C类IP地址192.168.0.0，主机号为192.168.0.0，缺省子网掩码255.255.0.0            

如果我们想将其划分为27个子网，而27的二进制值为`11011`，占5位，那么就是把主机号的前5位设置为1，以表示子网的范围
```text
1111 1111 . 1111 1111 . 0000 0000 . 0000 0000
1111 1111 . 1111 1111 . 1111 1000 . 0000 0000
```
如上图，2^5=32，而全0和全1是不可用的(因为全部为0，就是主机号，全部为1，就是网络号，切记)，所以就只有30个子网，那么也就是说在我们实际划分子网的时候，要先加2         
如上，子网掩码就是255.255.248.0，那么1.255~7.255，在同一个网络号，就是同一个网络下的主机，可以互相访问。当然不同子网下的主机，就不能互相访问了。             
同时，我们虽然只是按子网划分的，但是因为主机号部分为2^11=2048，也就是同一个子网下，可以存在2046台主机                        

如果我们有700台主机，700的二进制值为`1010111100`，占10位                    
```text
1111 1111 . 1111 1111 . 1111 1111 . 1111 1111
1111 1111 . 1111 1111 . 1111 1100 . 0000 0000
```
如上图最后面的2^10=1024，也就是同一个网络号下可以放1022台主机，它们可以互相访问        
而子网划分为2^6=64，去掉保留位，还有62个子网可以分配           

我们经常会看到`192.168.0.0/24`,这个24就是子网掩码，表示前24位为1，即`255.255.255.0`         

####默认网关
按照不同的分类标准，网关也分很多种，TCP/IP协议里的网关是最常用的       
大家都知道，从一个房间走到另一个房间，必然要经过一扇门，同样，从一个网络向另一个网络发送信息，也必须经过一道关口，这道关口就是网关            
那么网关到底是什么呢？网关实质上是一个网络通向其他网络的IP地址，比如有网络A和网络B，网络A的IP地址范围为`192.168.1.1~254`，子网掩码为`255.255.255.0`，网络B的IP地址范围为`192.168.2.1~254`，子网掩码为`255.255.255.0`，在没有路由器的情况下，两个网络之间是不能进行TCP/IP通信的，即使是两个网络连接在同一台交换机(或集线器)上，TCP/IP协议也会根据子网掩码(255.255.255.0)判定两个网络中的主机处在不同的网络里。         
而要实现这两个网络之间的通信，则必须通过网关，如果网络A中的主机发现数据包的目的主机不在本地网络中，就把数据包转发给它自己的网关，再由网关转发给网络B的网关，网络B的网关再转发给网络B的某个主机，网络B向网络A转发数据包的过程也是如此，所以说，只有设置好网关的IP地址，TCP/IP协议才能实现不同网络之间的相互通信，那么这个IP地址是哪台机器的IP地址呢? 网关的IP地址是具有路由功能的设备的IP地址，具有路由功能的设备有路由器、启用了路由协议的服务器(实质上相当于一台路由器)、代理服务器(也相当于一台路由器)。         
什么是默认网关？如果搞清了什么是网关，默认网关也就好理解了，就好像一个房间可以有多扇门一样，一台主机可以有多个网关，默认网关的意思是一台主机如果找不到可用的网关，就把数据包发给默认指定的网关，由这个网关来处理数据包，现在主机使用的网关，一般指的就是默认网关。        
意思是，所有需要转发的数据包，都经过默认网关的IP(接口)发送出去，当然返回也是从那里经过

####广播地址
广播地址(Broadcast Address)是专门用于同时向网络中所有主机进行发送的一个地址，在使用TCP/IP协议的网络中，主机号标识全为1的IP地址为 广播地址，广播的分组传送给主机号码段所涉及的所有计算机          

广播地址是根据IP地址和子网掩码计算得到         
例如IP地址`10.145.129.20`，子网掩码`255.255.248.0`
```text
IP    0000 1010 . 1001 0001 . 1000 0001 . 0001 0010
MASK  1111 1111 . 1111 1111 . 1111 1000 . 0000 0000
---------------------------------------------------
      0000 1010 . 1001 0001 . 1000 0111 . 1111 1111
```
也就是广播地址就是根据IP地址和子网掩码，计算得到网络号，再把主机号全部设置为1，得到的地址就是广播地址          

IP地址192.168.0.0/24，网络地址是192.168.0.0，广播地址是192.168.0.255            
IP地址192.168.0.0/26，网络地址是192.168.0.0，广播地址是192.168.0.63         
IP地址192.168.0.64/26，网络地址是192.168.0.64，广播地址是192.168.0.127         
IP地址192.168.0.128/26，网络地址是192.168.0.128，广播地址是192.168.0.191           
IP地址192.168.0.192/26，网络地址是192.168.0.192，广播地址是192.168.0.255         
```text
192.168.0.0/24   1100 0000 . 1010 1000 . 0000 0000 . 0000 0000
                 1111 1111 . 1111 1111 . 1111 1111 . 0000 0000
                 ---------------------------------
                 1100 0000 . 1010 1000 . 0000 0000 . 1111 1111
--------------------------------------------------------------
192.168.0.0/26   1100 0000 . 1010 1000 . 0000 0000 . 0000 0000
                 1111 1111 . 1111 1111 . 1111 1111 . 1100 0000
                 --------------------------------------
                 1100 0000 . 1010 1000 . 0000 0000 . 0011 1111
--------------------------------------------------------------
192.168.0.64/26  1100 0000 . 1010 1000 . 0000 0000 . 0100 0000
                 1111 1111 . 1111 1111 . 1111 1111 . 1100 0000
                 --------------------------------------
                 1100 0000 . 1010 1000 . 0000 0000 . 0111 1111
--------------------------------------------------------------
192.168.0.128/26 1100 0000 . 1010 1000 . 0000 0000 . 1000 0000
                 1111 1111 . 1111 1111 . 1111 1111 . 1100 0000
                 --------------------------------------
                 1100 0000 . 1010 1000 . 0000 0000 . 1011 1111
--------------------------------------------------------------
192.168.0.128/26 1100 0000 . 1010 1000 . 0000 0000 . 1100 0000
                 1111 1111 . 1111 1111 . 1111 1111 . 1100 0000
                 --------------------------------------
                 1100 0000 . 1010 1000 . 0000 0000 . 1111 1111
--------------------------------------------------------------
```


