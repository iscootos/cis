#here文档
在shell脚本程序中向一条命令传递输入的一种特殊方法是使用here文档。它允许一条命令在获得输入数据时就好像是在读取一个文件或键盘一样，而实际上是从脚本程序中得到输入数据。

here文档以两个连续的小于号`<<`开始，紧跟着一个特殊的字符序列，该序列将在文档的结尾处再次出现。`<<`是shell的标签重定向符，在这里，它强制命令的输入是一个here文档。这个特殊字符序列的作用就像一个标记，它告诉shell here文档结束的位置。因为这个标记序列不能出现在传递给命令的文档内容中，所以应该尽量使它既容易记忆又相当不寻常。

最简单的例子就是给cat命令提供输入数据，如下所示：
```bash
#!/bin/sh
cat <<!FUNKY!
hello
this is a here
document
!FUNKY!
```
```text
hello
this is a here
document
```
here文档功能可能看起来相当奇怪，但其实它的作用很大。因为它可以用来调用交互式的程序，比如一个编辑器，并向它提供一些事先定义好的输入。但它更常见的用途是在脚本程序中输出大量的文本，就像你在刚才的示例中看到的那样，从而可以避免用echo语句来输出每一行。你可以在标识符两端都使用感叹号`!`来确保不会引起混淆。

如果想按预定的方式处理一个文件中的几行，你可以使用`ed`行编辑器，并在脚本程序中通过here文档向它提供命令。

我们从名为a_text_file的文件开始，它的内容如下所示：
```text
This is line 1
This is line 2
This is line 3
This is line 4
```
你可以通过结合使用here文档和ed编辑器来编辑这个文件：
```bash
ed a_text_file <<!FunkyStuff!
3
d
.,\$s/is/was/
w
q
!FunkyStuff!

exit 0
```
```text
This is line 1
This is line 2
This was line 4
```
这个脚本程序只是调用ed编辑器并向它传递命令，先让它移动到第三行，然后删除该行，再把当前行（因为第三行刚刚被删除了，所以当前行现在就是原来的最后一行，即第四行）中的is替换为was。完成这些操作的`ed`命令来自脚本程序中的here文档--在标记`!FunkyStuff!`之间的那些内容。

注意，我们在here文档中用\字符来防止$字符被shell扩展。\字符的作用是对`$`进行转义，让shell知道不要尝试把`$s/is/was/`扩展为它的值，而它也确实没有值。shell把`\$`传递为`$`，再由`ed`编辑器对它进行解释。
