#setsockopt函数,设置套接口的选项
setsockopt()函数用于任意类型、任意状态套接口的设置选项值。尽管在不同协议层上存在选项，但本函数仅定义了最高的“套接口”层次上的选项。
```c
#include <sys/types.h>
#include <sys/socket.h>

int setsockopt(int sockfd, int level, int optname, const void *optval, socklen_t optlen);
```
sockfd 第一个参数socket是套接字描述符              
level  第二个参数level是被设置的选项的级别，如果想要在套接字级别上设置选项，就必须把level设置为 SOL_SOCKET,选项定义的层次;支持SOL_SOCKET、IPPROTO_TCP、IPPROTO_IP、IPPROTO_IPV6               
optname 指定准备设置的选项，option_name可以有哪些取值，这取决于level,以linux 2.6内核为例(在不同的平台上，这种关系可能会有不同)                  
optval  指针，执向存放选项值的缓冲区              
optlen  optval缓冲区长度          

linux内核中定义为
```c
static int setsockopt(struct socket *sock, int lvl, int opt, char __user *ov, unsigned int ol);
```

```text
SOL_SOCKET选项级别   选项值类型        获取/设置   Socket版本    说明
SO_ACCEPTCONN        布尔值            只能获取    1+            如为TRUE,表明套接字处于监听模式
SO_BROADCAST         布尔值            两种均可    1+            如TRUE，表明套接字已配置成对广播消息进行发送
SO_CONNECT_TIME      整数              只能获取    1+            返回套接字建立连接的时间，以秒为单位，如尚未连接，返回0xffffffff (微软专用)
SO_DEBUG             布尔值            两者均可    1+            如果TRUE，就允许调试输出 (W32不支持)
SO_DONTLINGER        布尔值            两者均可    1+            如果是TRUE，则禁用SO_LINGER 
SO_LINGER            struct linger     两者均可    1+            设置或获取当前的拖延值
SO_DONTROUTE         布尔值            两者均可    1+            如果TRUE,便直接向网络接口发送消息，毋需查询路由表 (微软无效)
SO_ERROR             布尔值            只能获得    1+            返回错误状态
SO_EXCLUSIVEADDRUSE  布尔值            两者均可    2+            如果TRUE，套接字绑定那个本地端口就不能重新被另一个进程使用
SO_KEEPALIVE         布尔值            两者均可    1+            如果TRUE，套接字就会进行配置，在会话过程中发送”保持活动”消息
SO_MAX_MSG_SIZE      无符号整数        只能获取    2+            对一个面向消息的套接字来说，一条消息的最大长度
SO_OOBINLINE         布尔值            两者均可    1+            如果是TRUE，带外数据就会在普通数据流中返回 (W32不支持)
SO_PROTOCOL_INFO     WSAPROTOCOL_INFO  只能获得    2+            套接字绑定的那种协议的特征      
SO_RCVBUF            整数              两者均可    1+            面向接收操作，为每个套接字分别获取或设置缓冲区长度 
SO_REUSEADDR         布尔值            两者均可    1+            如果是TRUE，套接字就可与一个正由其他套接字使用的地址绑定到一起，或与处在TIME_WAIT状态的地址绑定到一起
SO_SNDBUF            布尔值            两者均可    1+            设置分配给套接字的数据发送缓冲区的大小
SO_TYPE              整数              只能获取    1+            返回指定套接字的类型（如SOCK_DGRAM和SOCK_STREAM等等
SO_SNDTIMEO          整数              两者均可    1+            获取或设置套接字上的数据发送超时时间（以毫秒为单位）
SO_RCVTIMEO          整数              两者均可    1+            获取或设置与套接字上数据接收对应的超时时间值（以毫秒为单位）
SO_UPDATE_ACCEPT_CONTEXT  SOCKET       两者均可    1+            更新SOCKET状态
```
```text
IPPROTO_IP选项级别   选项值类型        获取/设置   Socket版本    说明
IP_OPTIONS           char[]            两者均可    1+            设置或获取I P头内的I P选项
IP_HDRINCL           布尔值            两者均可    2+            如果是TRUE,IP头就会随即将发送的数据一起提交，并从读取的数据中返回，如下表
```
表IP_HDRINCL
```text
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
4位版本                 |  4位头长度                   |  8位服务类型           |  16位总长
(ipv4 or ipv6)          |  (32位字一共有多少个)        |  (参阅IP_TOS)          |  设置或获取I P头内的I P选项
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
16位标识                                                                        |  3个1位标志 (仅在I P包需要分割为   |   13位分段偏移 (仅在ip包需要分割为较小的包时才会用到)
(对发出的每个ip包进行“唯一性”标定, 每发出一个数据包，系统都会递增这个值)        |  较小的包时才会用到)               |   
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
8位存在时间            |  8位协议类型                                           |  16位头检验和
(参阅IP_TTL)           |  (用于对进入的数据包组装,如：TCP, IDP, IGMP和ICMP等等) |  (校验和是指对整个I P头进行1 6位1的求余总和结果, 不针对实际的数据)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
32位源IP地址
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
32位目标IP地址
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IP选项(如果有的话,详见IP_OPTIONS)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
数据<!--[if !supportMisalignedColumns]-->   <!--[endif]--> 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
```
表IP_HDRINCL
```text
IP_TOS                  整数                 两者均可    1+        IP服务类型
IP_TTL                  整数                 两者均可    1+        I P协议的“存在时间” （TTL）参数
IP_MULTICAST_IF         无符号长整数         两者均可    1+        获取或设置打算从它上面发出多播数据的本地接口
IP_MULTICAST_TTL        整数                 两者均可    1+        为套接字获取或设置多播数据包的存在时间
IP_MULTICAST_LOOP       布尔值               两者均可    1+        如果TRUE，发至多播地址的数据将原封不动地“反射”或“反弹”回套接字的进入缓冲区
IP_ADD_MEMBERSHIP       struct ip_mreq       只能设置    1+        在指定的I P组内为套接字赋予成员资格
IP_DROP_MEMBERSHIP      struct ip_mre1       只能设置    1+        将套接字从指定的I P组内删去（撤消成员资格）
IP_DONTFRAGMENT         布尔值               两者均可    1+        如果是TRUE，就不对I P数据报进行分段
```
```text
IPPROTO_TCP选项级别     选项值类型        获取/设置   Socket版本    说明
TCP_NODELAY             布尔值            两者均可    1+            若为TRUE, 就会在套接字上禁用Nagle算法 (只适用于流式套接字)
```


